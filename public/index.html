<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TranscriberPro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root{
      --bg: #eef0ff;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#667085;

      --border:#e6e8f2;
      --shadow: 0 18px 50px rgba(16,24,40,.12);
      --shadow2: 0 10px 28px rgba(16,24,40,.10);
      --radius: 18px;
      --radius2: 22px;

      --brand:#5b6cff;
      --brandDark:#4456ff;
      --brandTint:#eef0ff;

      --danger:#b42318;
      --success:#067647;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background: var(--bg);
      line-height: 1.45;
    }

    /* soft blobs (no gradients) */
    .blob{
      position: fixed;
      width: 520px;
      height: 520px;
      border-radius: 999px;
      filter: blur(50px);
      opacity: .28;
      pointer-events:none;
      z-index:0;
    }
    .blob.one{ background: #c9d0ff; top:-160px; left:-200px; }
    .blob.two{ background: #d6f0ff; bottom:-220px; right:-220px; opacity:.22; }
    .blob.three{ background: #ffd9f1; top: 520px; right:-260px; opacity:.16; }

    /* ---------- RESPONSIVE CONTAINERS ---------- */
    .page{
      position:relative;
      z-index:1;
      width: 100%;
      margin: 0 auto;
      padding: 14px 14px 28px;
      max-width: 1100px; /* desktop width */
    }
    /* On very small screens, keep it tight */
    @media (max-width: 520px){
      .page{ padding: 12px 12px 22px; }
    }

    /* Top bar */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding: 10px 8px 2px;
    }
    .brandmark{
      width:32px;height:32px;
      border-radius: 12px;
      background: var(--brand);
      display:grid;place-items:center;
      box-shadow: 0 10px 20px rgba(91,108,255,.25);
      flex:0 0 auto;
    }
    .brandmark svg{ width:16px;height:16px; fill:#fff; }
    .brandname{
      font-weight: 900;
      letter-spacing: -.2px;
      font-size: 14px;
    }

    /* Hero */
    .hero{
      margin-top: 10px;
      text-align:center;
      padding: 18px 10px 10px;
    }
    .hero h1{
      margin: 10px 0 8px;
      font-size: 34px;
      letter-spacing: -1.2px;
      line-height: 1.08;
    }
    .hero h1 .accent{ color: var(--brandDark); }
    .hero p{
      margin: 0 auto 12px;
      max-width: 60ch;
      font-size: 14px;
      color: var(--muted);
    }

    /* Stats */
    .stats{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin: 14px auto 16px;
      max-width: 640px;
    }
    .stat{
      background: rgba(255,255,255,.7);
      border: 1px solid rgba(255,255,255,.9);
      border-radius: 16px;
      padding: 12px 10px;
      box-shadow: 0 10px 28px rgba(16,24,40,.08);
    }
    .stat b{
      display:block;
      font-size: 15px;
      letter-spacing: -.4px;
    }
    .stat span{
      display:block;
      margin-top: 2px;
      font-size: 11.5px;
      color: var(--muted);
    }
    @media (max-width: 520px){
      .stats{ grid-template-columns: 1fr; max-width: 360px; }
    }

    /* ---------- MAIN LAYOUT: desktop 2 columns, mobile 1 column ---------- */
    .layout{
      display:grid;
      grid-template-columns: 1fr; /* mobile default */
      gap: 16px;
      align-items:start;
      margin-top: 10px;
    }
    @media (min-width: 900px){
      .layout{
        grid-template-columns: 520px 1fr; /* app card + right rail */
        gap: 18px;
      }
      .hero{ padding-bottom: 0; }
    }

    /* Main card */
    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardpad{ padding: 14px; }

    .cardtitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 14px 14px 0;
    }
    .cardtitle b{
      font-size: 13px;
      letter-spacing: -.2px;
    }
    .badge{
      font-size: 11px;
      font-weight: 800;
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--brandTint);
      color: #3340d6;
      border: 1px solid #dfe3ff;
      white-space:nowrap;
    }

    /* Upload block */
    .drop{
      margin-top: 10px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: #fbfbff;
      padding: 12px;
    }
    .dropTop{
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .iconbox{
      width:38px;height:38px;
      border-radius: 14px;
      background: var(--brandTint);
      border: 1px solid #dfe3ff;
      display:grid;place-items:center;
      flex:0 0 auto;
    }
    .iconbox svg{ width:18px;height:18px; fill:#3340d6; }

    .dropText b{
      display:block;
      font-size: 13px;
      letter-spacing: -.2px;
    }
    .dropText span{
      display:block;
      margin-top: 2px;
      font-size: 12px;
      color: var(--muted);
    }

    /* Buttons */
    .btn{
      width:100%;
      margin-top: 10px;
      border: 1px solid transparent;
      border-radius: 16px;
      padding: 12px 12px;
      font-size: 13px;
      font-weight: 900;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      user-select:none;
    }
    .btn svg{ width:16px;height:16px; }
    .btnPrimary{
      background: var(--brand);
      color:#fff;
      box-shadow: 0 12px 28px rgba(91,108,255,.28);
    }
    .btnPrimary:hover{ background: var(--brandDark); }
    .btnGhost{
      background:#fff;
      border-color: var(--border);
      color: var(--text);
    }
    .btnGhost:hover{ background:#f7f8ff; }
    .btn:disabled{
      opacity:.55;
      cursor:not-allowed;
      box-shadow:none;
    }

    /* Status + progress */
    .statusRow{
      margin-top: 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      font-size: 12px;
      color: var(--muted);
    }
    .meter{
      flex:1;
      min-width: 180px;
      height: 10px;
      border-radius: 999px;
      background:#eef2ff;
      border:1px solid #e6e8f2;
      overflow:hidden;
    }
    .fill{
      height:100%;
      width:0%;
      background: var(--brand);
      transition: width .2s ease;
    }
    .err{ color: var(--danger); font-weight: 900; }

    /* Transcript */
    textarea{
      width:100%;
      margin-top: 12px;
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 12px;
      min-height: 220px;
      font-size: 13px;
      line-height: 1.5;
      resize: vertical;
      background:#fff;
      box-shadow: inset 0 1px 0 rgba(16,24,40,.03);
    }

    .toolRow{
      display:flex;
      gap:10px;
      margin-top: 10px;
      flex-wrap:wrap;
    }
    .mini{
      flex:1;
      padding: 10px 10px;
      border-radius: 14px;
      border:1px solid var(--border);
      background:#fff;
      font-size: 12px;
      font-weight: 900;
      cursor:pointer;
      box-shadow: 0 8px 18px rgba(16,24,40,.06);
    }
    .mini:hover{ background:#f7f8ff; }

    /* Right rail sections */
    .section{
      padding: 10px;
      border-radius: var(--radius2);
      background: rgba(255,255,255,.5);
      border: 1px solid rgba(255,255,255,.8);
      box-shadow: var(--shadow2);
    }
    .section + .section{ margin-top: 14px; }

    .sectionTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 6px 4px 10px;
    }
    .sectionTitle b{
      font-size: 12.5px;
      letter-spacing: -.2px;
    }
    .sectionTitle span{
      font-size: 11px;
      color: var(--muted);
      font-weight: 800;
    }
    .list{ display:grid; gap:10px; }
    .item{
      background:#fff;
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 12px;
      box-shadow: 0 10px 22px rgba(16,24,40,.07);
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .itemIcon{
      width:34px;height:34px;
      border-radius: 14px;
      background: var(--brandTint);
      border: 1px solid #dfe3ff;
      display:grid;place-items:center;
      flex:0 0 auto;
    }
    .itemIcon svg{ width:16px;height:16px; fill:#3340d6; }
    .item b{ display:block; font-size: 12.8px; letter-spacing:-.2px; }
    .item p{ margin: 4px 0 0; font-size: 12px; color: var(--muted); }

    /* Footer */
    .footer{
      margin-top: 16px;
      text-align:center;
      color: var(--muted);
      font-size: 11.5px;
      padding: 14px 10px 6px;
    }
    .footer b{ color: var(--text); }
  </style>
</head>

<body>
  <div class="blob one"></div>
  <div class="blob two"></div>
  <div class="blob three"></div>

  <div class="page">
    <div class="topbar">
      <div class="brandmark" aria-hidden="true">
        <svg viewBox="0 0 24 24">
          <path d="M6 2h8l4 4v16a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2Zm8 1.5V7h3.5L14 3.5ZM10 10.2v5.6c0 .7.8 1.1 1.4.7l4.1-2.8c.6-.4.6-1.2 0-1.6l-4.1-2.8c-.6-.4-1.4 0-1.4.9Z"/>
        </svg>
      </div>
      <div class="brandname">TranscriberPro</div>
    </div>

    <div class="hero">
      <h1>Transcribe <span class="accent">Anything</span>, Reuse <span class="accent">Everything</span></h1>
      <p>
        Upload a video or audio file and instantly get a clean transcript you can reuse for captions,
        hooks, scripts, summaries, and notes.
      </p>

      <div class="stats" aria-label="Quick stats">
        <div class="stat"><b>50+</b><span>formats supported</span></div>
        <div class="stat"><b>1M+</b><span>words processed</span></div>
        <div class="stat"><b>99.9%</b><span>job reliability</span></div>
      </div>
    </div>

    <!-- Responsive layout starts here -->
    <div class="layout">
      <!-- LEFT: App card -->
      <div class="card">
        <div class="cardtitle">
          <div>
            <b>Video → Transcript</b>
            <div style="margin-top:4px;font-size:11.5px;color:var(--muted);font-weight:800;">
              Upload once · Run a job · Copy output
            </div>
          </div>
          <div class="badge">Pro · Private Beta</div>
        </div>

        <div class="cardpad">
          <div class="drop" id="dropzone">
            <div class="dropTop">
              <div class="iconbox" aria-hidden="true">
                <svg viewBox="0 0 24 24"><path d="M12 3 5 10h4v7h6v-7h4l-7-7Zm-9 18h18v2H3v-2Z"/></svg>
              </div>
              <div class="dropText">
                <b>Upload your file</b>
                <span>MP4, MOV, MP3, WAV. Drag & drop here or use the button below.</span>
              </div>
            </div>
          </div>

          <!-- One button only (choose+upload) -->
          <button class="btn btnPrimary" id="uploadBtn" type="button">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="#fff" d="M12 2 5 9h4v6h6V9h4l-7-7ZM5 20h14v2H5v-2Z"/></svg>
            Upload video / audio
          </button>

          <input id="file" type="file" accept="video/*,audio/*" style="display:none;" />

          <button class="btn btnGhost" id="transcribeBtn" type="button" disabled>
            <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="#0f172a" d="M8 5v14l11-7L8 5Z"/></svg>
            Start transcription
          </button>

          <div class="statusRow">
            <span id="statusText">Waiting for upload…</span>
            <div class="meter"><div class="fill" id="fill"></div></div>
            <span id="pct" style="min-width:44px;text-align:right;">0%</span>
          </div>

          <textarea id="out" placeholder="Transcript will appear here…"></textarea>

          <div class="toolRow">
            <button class="mini" id="copyBtn" type="button">Copy</button>
            <button class="mini" id="downloadBtn" type="button">Download</button>
            <button class="mini" id="clearBtn" type="button">Clear</button>
          </div>
        </div>
      </div>

      <!-- RIGHT: Sections (desktop side rail; on mobile it stacks below) -->
      <div>
        <div class="section">
          <div class="sectionTitle">
            <b>Common Workflows</b>
            <span>paid tool features</span>
          </div>
          <div class="list">
            <div class="item">
              <div class="itemIcon" aria-hidden="true">
                <svg viewBox="0 0 24 24"><path d="M4 6h16v2H4V6Zm0 5h10v2H4v-2Zm0 5h16v2H4v-2Z"/></svg>
              </div>
              <div>
                <b>TikTok / Reels Captions</b>
                <p>Turn a clip into text you can format into on-screen captions and posts.</p>
              </div>
            </div>

            <div class="item">
              <div class="itemIcon" aria-hidden="true">
                <svg viewBox="0 0 24 24"><path d="M3 5h18v14H3V5Zm2 2v10h14V7H5Zm3 1h8v2H8V8Zm0 4h6v2H8v-2Z"/></svg>
              </div>
              <div>
                <b>VSL Scripts & Hooks</b>
                <p>Transcribe recordings and reuse hooks, bullets, and sections.</p>
              </div>
            </div>

            <div class="item">
              <div class="itemIcon" aria-hidden="true">
                <svg viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7v4a4 4 0 0 0 4 4h1v3h2v-3h1a4 4 0 0 0 4-4v-1h-2v1a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V9a5 5 0 0 1 10 0v3h2V9a7 7 0 0 0-7-7Z"/></svg>
              </div>
              <div>
                <b>Calls, Podcasts, Meetings</b>
                <p>Keep a written record and quickly search important points.</p>
              </div>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="sectionTitle">
            <b>Coming Soon</b>
            <span>next upgrades</span>
          </div>
          <div class="list">
            <div class="item">
              <div class="itemIcon" aria-hidden="true">
                <svg viewBox="0 0 24 24"><path d="M12 2 3 6v6c0 5 3.8 9.7 9 10 5.2-.3 9-5 9-10V6l-9-4Zm-1 14-4-4 1.4-1.4L11 13.2l5.6-5.6L18 9l-7 7Z"/></svg>
              </div>
              <div>
                <b>Timestamps + Chapters</b>
                <p>Generate timestamps so you can jump to key moments faster.</p>
              </div>
            </div>

            <div class="item">
              <div class="itemIcon" aria-hidden="true">
                <svg viewBox="0 0 24 24"><path d="M21 7 9 19l-5.5-5.5L5 12l4 4L19.6 5.4 21 7Z"/></svg>
              </div>
              <div>
                <b>Auto Summary + Highlights</b>
                <p>Summarize the transcript into bullets, hooks, and action steps.</p>
              </div>
            </div>

            <div class="item">
              <div class="itemIcon" aria-hidden="true">
                <svg viewBox="0 0 24 24"><path d="M16 1H4a2 2 0 0 0-2 2v14h2V3h12V1Zm4 4H8a2 2 0 0 0-2 2v16h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Zm0 18H8V7h12v16ZM10 11h8v2h-8v-2Zm0 4h8v2h-8v-2Z"/></svg>
              </div>
              <div>
                <b>Export to Captions & Scripts</b>
                <p>One click: captions format, hooks list, or VSL structure.</p>
              </div>
            </div>
          </div>
        </div>

        <div class="footer">
          <div><b>TranscriberPro</b> — private beta build for testing.</div>
          <div>Payments/login can be added later when you’re ready to launch.</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const fileInput = document.getElementById("file");
    const uploadBtn = document.getElementById("uploadBtn");
    const transcribeBtn = document.getElementById("transcribeBtn");
    const statusText = document.getElementById("statusText");
    const pct = document.getElementById("pct");
    const fill = document.getElementById("fill");
    const out = document.getElementById("out");
    const dropzone = document.getElementById("dropzone");

    const copyBtn = document.getElementById("copyBtn");
    const downloadBtn = document.getElementById("downloadBtn");
    const clearBtn = document.getElementById("clearBtn");

    let uploadId = null;

    function setStatus(msg, progress = null, isErr = false) {
      statusText.textContent = msg;
      statusText.className = isErr ? "err" : "";
      if (typeof progress === "number") {
        const p = Math.max(0, Math.min(100, progress));
        pct.textContent = p + "%";
        fill.style.width = p + "%";
      }
    }

    async function apiUpload(file) {
      const form = new FormData();
      form.append("file", file);
      const r = await fetch("/api/upload", { method: "POST", body: form });
      const d = await r.json().catch(() => ({}));
      if (!r.ok) throw new Error(d?.error || "Upload failed");
      return d;
    }

    async function apiStartJob(uploadId) {
      const r = await fetch("/api/jobs", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ uploadId })
      });
      const d = await r.json().catch(() => ({}));
      if (!r.ok) throw new Error(d?.error || "Failed to start job");
      return d.jobId;
    }

    async function pollJob(jobId) {
      while (true) {
        await new Promise(r => setTimeout(r, 1200));
        const r = await fetch(`/api/jobs/${jobId}`);
        const j = await r.json().catch(() => ({}));
        if (!r.ok) throw new Error(j?.error || "Job status failed");

        const msg = j?.progress?.message || "Processing…";
        const p = (typeof j?.progress?.pct === "number") ? j.progress.pct : 10;
        setStatus(msg, p, false);

        if (j.status === "done") {
          out.value = j.resultText || "";
          setStatus("Done.", 100, false);
          return;
        }
        if (j.status === "error") {
          throw new Error(j.error || "Transcription failed.");
        }
      }
    }

    // One button: choose file -> auto upload
    uploadBtn.addEventListener("click", () => fileInput.click());

    fileInput.addEventListener("change", async () => {
      const f = fileInput.files?.[0];
      if (!f) return;

      uploadBtn.disabled = true;
      transcribeBtn.disabled = true;
      out.value = "";
      uploadId = null;
      setStatus("Uploading…", 8, false);

      try {
        const res = await apiUpload(f);
        uploadId = res.uploadId;
        setStatus(`Uploaded: ${res.originalName || f.name}`, 20, false);
        setStatus("Ready to transcribe.", 20, false);
        transcribeBtn.disabled = false;
      } catch (e) {
        setStatus("Error: " + e.message, 0, true);
      } finally {
        uploadBtn.disabled = false;
        fileInput.value = "";
      }
    });

    // Drag & drop -> auto upload
    dropzone.addEventListener("dragover", (e) => { e.preventDefault(); dropzone.style.borderColor = "#b8c0ff"; });
    dropzone.addEventListener("dragleave", () => { dropzone.style.borderColor = "var(--border)"; });
    dropzone.addEventListener("drop", async (e) => {
      e.preventDefault();
      dropzone.style.borderColor = "var(--border)";
      const f = e.dataTransfer.files?.[0];
      if (!f) return;

      uploadBtn.disabled = true;
      transcribeBtn.disabled = true;
      out.value = "";
      uploadId = null;
      setStatus("Uploading…", 8, false);

      try {
        const res = await apiUpload(f);
        uploadId = res.uploadId;
        setStatus(`Uploaded: ${res.originalName || f.name}`, 20, false);
        setStatus("Ready to transcribe.", 20, false);
        transcribeBtn.disabled = false;
      } catch (e2) {
        setStatus("Error: " + e2.message, 0, true);
      } finally {
        uploadBtn.disabled = false;
      }
    });

    transcribeBtn.addEventListener("click", async () => {
      if (!uploadId) return;
      transcribeBtn.disabled = true;
      setStatus("Starting transcription…", 30, false);

      try {
        const jobId = await apiStartJob(uploadId);
        setStatus("Transcribing…", 40, false);
        await pollJob(jobId);
      } catch (e) {
        setStatus("Error: " + e.message, 0, true);
      } finally {
        transcribeBtn.disabled = false;
      }
    });

    copyBtn.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(out.value || "");
        setStatus("Copied.", 100, false);
      } catch {
        setStatus("Copy failed. Copy manually.", 100, true);
      }
    });

    downloadBtn.addEventListener("click", () => {
      const text = out.value || "";
      const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "transcript.txt";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      setStatus("Downloaded.", 100, false);
    });

    clearBtn.addEventListener("click", () => {
      out.value = "";
      setStatus("Cleared.", 0, false);
    });

    setStatus("Waiting for upload…", 0, false);
  </script>
</body>
</html>
